<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>CityView</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" href="favicon.ico">

    <link href='https://fonts.googleapis.com/css?family=Work+Sans:400,300,600,400italic,700' rel='stylesheet' type='text/css'>
    
    <!-- Animate.css -->
    <link rel="stylesheet" href="css/animate.css">
    
    <!-- Magnific Popup -->
    <link rel="stylesheet" href="css/magnific-popup.css">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="css/bootstrap.css">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="css/icomoon.css">
    <!-- Theme style  -->
    <link rel="stylesheet" href="css/style.css">

    <!-- Modernizr JS -->
    <script src="js/modernizr-2.6.2.min.js"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
    <script src="js/respond.min.js"></script>
    <![endif]-->
    </head>
    <body>
    
    <div id="fh5co-wrap">
        <header id="fh5co-header">
            <div class="container">
                <nav class="fh5co-main-nav">
                    <ul>
                        <li class="fh5co-active"><a href="index.html"><span style="font-weight:600">Home</span></a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div class="fh5co-hero" style="background-image: url(images/bg.jpg);" data-stellar-background-ratio="0.5">
            <div class="overlay"></div>
            <div class="container">
                <div class="row">
                    <div class="col-md-8 col-md-offset-2 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0 text-center fh5co-table">
                        <div class="fh5co-intro fh5co-table-cell">
                            <h1 class="text-center">CityView</h1>					
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="fh5co-section">
            <div class="container">

                <div class="row">
                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-md-6">
                                <h2>Booking Estimation</h2>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <input type="text" name ="lat" class="form-control" placeholder="Latitude">
                        </div>
                        <div class="form-group">
                            <input type="text" name ="long" class="form-control" placeholder="Longitude">
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary btn-md" onclick="cal()">Calculate</button>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <p id="p1"></p>
                        <p id="p2"></p>
                    </div>
                </div>

            </div>
        </div>
        
        <div class="fh5co-section">
            <div class="container">
                <div class="row">
                    <div class="col-md-5">
                        <h2>94129 is the most expensive zipcode</h2>
                        <p>It's not surprising that the most expensive location is near the Golden Gate Bridge. If you own a location in 94129, expect to make a lot of money.</p>
                    </div>
                    <div class="col-md-7">
                        <img src="images/chart1.png"  class="img-responsive">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="fh5co-section">
            <div class="container">
                <div class="row">
                    <div class="col-md-5">
                        <h2>More bedrooms, More money</h2>
                        <p>There is a direct relationship between the number of bedrooms and the average price listing. Be on the lookout if your residence has many bedrooms.</p>
                    </div>
                    <div class="col-md-7">
                        <img src="images/chart2.png" class="img-responsive">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="fh5co-section">
            <div class="container">
                <div class="row">
                    <div class="col-md-5">
                        <h2>More reviews = Less profit</h2>
                        <p>More reviews are correlated with a cheaper listing. This is the case because more people will choose cheaper listings and review those instead of more expensive listings. It can be tricky to figure out the optimal price to maximize customers and profit. So, I built CityView to help with that.</p>
                    </div>
                    <div class="col-md-7">
                        <img src="images/chart3.png" class="img-responsive">
                    </div>
                </div>
            </div>
        </div>

    </div> <!-- END fh5co-wrap -->


    <footer id="fh5co-footer">
        <div class="container">
            <div class="row">
                <div class="col-md-12 fh5co-copyright text-center">
                    <p><small>&copy; 2017 Abel Tesfaye</small></p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- jQuery -->
    <script src="js/jquery.min.js"></script>
    <!-- jQuery Easing -->
    <script src="js/jquery.easing.1.3.js"></script>
    <!-- Bootstrap -->
    <script src="js/bootstrap.min.js"></script>
    <!-- Waypoints -->
    <script src="js/jquery.waypoints.min.js"></script>
    <!-- Stellar -->
    <script src="js/jquery.stellar.min.js"></script>
    <!-- MAIN JS -->
    <script src="js/main.js"></script>
    
        
    <script src="https://d3js.org/d3.v4.js"></script>
    <script>
        function cal() {
            var lat = document.getElementsByName("lat")[0].value;//read input
            var lon = document.getElementsByName("long")[0].value;
            
            if(!lat || !lon) {
                alert("Please fill in the required fields");
                return;
            }
            
            if(lat < 37.70692769 || lat > 37.83109279) {//min and max from data
                alert("Please enter a valid San Francisco geo-location. Latitude should be between 37.70692769 and 37.83109279");
                return;
            }
            
            if(lon < -122.5115 || lon > -122.3647585) {//min and max from data
                alert("Please enter a valid San Francisco geo-location. Longitude should be between -122.5115 and -122.3647585");
                return;
            }
                
            //read the csv
            d3.csv("listings.csv", function(data) {
                for (var i =0; i < data.length; i++) {
                    var x = data[i];
                    x.latitude = Math.abs(x.latitude-lat); 
                    x.longitude = Math.abs(x.longitude-lon);
                }
                //sort the entries by how far each one is from the input data
                data.sort(function (a,b) {
                    var aDel = a.latitude+a.longitude;
                    var bDel = b.latitude+b.longitude;
                    if (aDel < bDel)
                        return -1;
                    if(aDel > bDel)
                        return 1;
                    return 0;
                });
                var price = (data[0].price.replace("$","")) * 7;
                document.getElementById("p1").innerHTML = "The predicted weekly income for this location is $" + price;
                document.getElementById("p2").innerHTML = "The optimal booking price for this location is $" + Math.round(price*.923);
            });
        }
    </script>

    </body>
</html>

